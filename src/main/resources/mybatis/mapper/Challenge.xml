<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.healthplan.mapper.ChallengeMapper">

    <!-- 챌린지 등록 -->
    <insert id="createChallengeReg" parameterType="com.healthplan.domain.ChallengeVO">
        INSERT INTO board (wdate, btype, bcontents, dif, chno)
        VALUES (SYSDATE, #{btype}, #{bcontents}, #{dif}, #{chno})
    </insert>

    <!-- 챌린지 리스트 조회 -->
    <select id="selectChallengeList" resultType="com.healthplan.domain.ChallengeVO">
        SELECT bno, btype, title, wdate, bcontents, dif, chno
        FROM board
        WHERE btype = 'H'
        ORDER BY TRUNC(WDATE) DESC, CHNO ASC
    </select>

    <!-- 최근 챌린지 3개 조회 -->
    <select id="selectRecentChallenges" parameterType="int" resultType="com.healthplan.domain.ChallengeVO">
        <![CDATA[
        SELECT * FROM (
            SELECT bno, btype, title, wdate, bcontents, dif, chno
            FROM board
            WHERE btype = 'H'
            ORDER BY TRUNC(WDATE) DESC, CHNO ASC
        ) WHERE ROWNUM <= #{limit}
        ]]>
    </select>
</mapper>
